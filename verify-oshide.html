<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VÃ©rifier Oshide</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background: #0a0b0d;
            color: #00ff00;
        }
        .container {
            background: #1a1d23;
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #00ff00;
        }
        h1 {
            color: #00ff00;
            text-align: center;
            margin-bottom: 30px;
        }
        .btn {
            background: #00ff00;
            color: #0a0b0d;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 700;
            width: 100%;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
        }
        .btn:hover {
            background: #00cc00;
        }
        .log {
            background: #0a0b0d;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            white-space: pre-wrap;
            max-height: 600px;
            overflow-y: auto;
            border: 1px solid #00ff00;
        }
        .success { color: #00ff00; }
        .error { color: #ff4444; }
        .warning { color: #ffaa00; }
        .info { color: #00aaff; }
    </style>
</head>
<body>
    <div class="container">
        <h1>âœ… VÃ©rifier le compte Oshide</h1>

        <button class="btn" onclick="verifyOshide()">ğŸ” VÃ©rifier Oshide</button>
        <button class="btn" onclick="testLogin()" style="background: #00aaff;">ğŸ”‘ Tester connexion</button>

        <div class="log" id="log"></div>
    </div>

    <script>
        const SUPABASE_URL = 'https://vjsovnhmjgehqawjmqxn.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZqc292bmhtamdlaHFhd2ptcXhuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA0MjQ4OTgsImV4cCI6MjA3NjAwMDg5OH0.uLqNP1Xb6uhrVBH_ESW7eemMdJ08cTrYZ9C0QHvAsDk';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `<span class="${type}">[${timestamp}] ${message}</span>\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        async function verifyOshide() {
            document.getElementById('log').innerHTML = '';
            log('ğŸ” VÃ©rification du compte Oshide...', 'info');
            log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'info');
            log('', 'info');

            try {
                const { data: vas, error } = await supabase
                    .from('vas')
                    .select('*')
                    .ilike('name', 'oshide');

                if (error) {
                    log(`âŒ Erreur: ${error.message}`, 'error');
                    return;
                }

                if (!vas || vas.length === 0) {
                    log('âŒ VA Oshide non trouvÃ©', 'error');
                    return;
                }

                const oshide = vas[0];

                log(`âœ… VA Oshide trouvÃ©!`, 'success');
                log('', 'info');
                log('ğŸ“‹ DÃ‰TAILS COMPLETS:', 'info');
                log(`   Nom: ${oshide.name}`, 'success');
                log(`   ID: ${oshide.id}`, 'info');
                log(`   Organization ID: ${oshide.organization_id}`, 'info');
                log(`   User ID: ${oshide.user_id || 'NULL'}`, oshide.user_id ? 'success' : 'error');
                log(`   Email: ${oshide.email || 'Non dÃ©fini'}`, oshide.email ? 'success' : 'warning');
                log('', 'info');

                if (oshide.user_id) {
                    log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'success');
                    log('âœ… COMPTE CONFIGURÃ‰ AVEC SUCCÃˆS!', 'success');
                    log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'success');
                    log('', 'info');
                    log('ğŸ” IDENTIFIANTS DE CONNEXION:', 'success');
                    log('   Email: oshide@test.com', 'success');
                    log('   Mot de passe: oshide123', 'success');
                    log('', 'info');
                    log('ğŸ’¡ Oshide peut maintenant se connecter au dashboard!', 'info');
                } else {
                    log('âŒ Le user_id n\'a pas Ã©tÃ© dÃ©fini', 'error');
                    log('ğŸ’¡ Relancer le script create-oshide-auth.html', 'warning');
                }

            } catch (error) {
                log(`âŒ ERREUR: ${error.message}`, 'error');
                console.error(error);
            }
        }

        async function testLogin() {
            document.getElementById('log').innerHTML = '';
            log('ğŸ”‘ Test de connexion avec oshide@test.com...', 'info');
            log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'info');
            log('', 'info');

            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: 'oshide@test.com',
                    password: 'oshide123'
                });

                if (error) {
                    log(`âŒ Erreur de connexion: ${error.message}`, 'error');
                    return;
                }

                log('âœ… CONNEXION RÃ‰USSIE!', 'success');
                log('', 'info');
                log('ğŸ“‹ Informations utilisateur:', 'info');
                log(`   ID: ${data.user.id}`, 'success');
                log(`   Email: ${data.user.email}`, 'success');
                log(`   CrÃ©Ã© le: ${new Date(data.user.created_at).toLocaleString()}`, 'info');
                log('', 'info');
                log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'success');
                log('âœ… Le compte fonctionne parfaitement!', 'success');
                log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”', 'success');

                // Se dÃ©connecter aprÃ¨s le test
                await supabase.auth.signOut();

            } catch (error) {
                log(`âŒ ERREUR: ${error.message}`, 'error');
                console.error(error);
            }
        }
    </script>
</body>
</html>
